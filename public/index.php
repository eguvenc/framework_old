<?php
/*
|--------------------------------------------------------------------------
| Disable php.ini errors to use set_error_handler() func
|--------------------------------------------------------------------------
*/
ini_set('display_errors', 1);
/*
|--------------------------------------------------------------------------
| Disable all php errors to use set_error_handler() func
|--------------------------------------------------------------------------
*/
error_reporting(E_ALL);

/*
|--------------------------------------------------------------------------
| Root Constant
|--------------------------------------------------------------------------
*/
define('ROOT', dirname(__DIR__).'/');
/*
|--------------------------------------------------------------------------
| Constants.
|--------------------------------------------------------------------------
*/
require ROOT .'constants';
/*
|--------------------------------------------------------------------------
| Register Autoloader
|--------------------------------------------------------------------------
*/
require ROOT .'vendor/autoload.php';
/*
|--------------------------------------------------------------------------
| Only for parse errors
|--------------------------------------------------------------------------
*/
require OBULLO .'Application/Autoloader.php';
Obullo\Application\Autoloader::register();
/*
|--------------------------------------------------------------------------
| Set timezone identifier
|--------------------------------------------------------------------------
*/
date_default_timezone_set('Europe/London');
/*
|--------------------------------------------------------------------------
| Container
|--------------------------------------------------------------------------
*/
$container = new League\Container\Container;
/*
|--------------------------------------------------------------------------
| Application
|--------------------------------------------------------------------------
*/
$app = new Obullo\Application\App($container);
/*
|--------------------------------------------------------------------------
| Benchmark start
|--------------------------------------------------------------------------
*/
$app->benchmarkStart();
/*
|--------------------------------------------------------------------------
| Http server
|--------------------------------------------------------------------------
*/
$server = Obullo\Http\Zend\Diactoros\Server::createServerFromRequest(
    $app,
    $app->getRequest(),
    $app->getResponse()
);
/*
|--------------------------------------------------------------------------
| Run
|--------------------------------------------------------------------------
*/
$server->listen();
/*
|--------------------------------------------------------------------------
| Benchmark end
|--------------------------------------------------------------------------
*/
$app->benchmarkEnd();